<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Extract quantiles of pwm of intervals from a motif database — gextract_pwm.quantile • prego</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Extract quantiles of pwm of intervals from a motif database — gextract_pwm.quantile"><meta name="description" content="Extract for each interval its quantile in the genome for each motif given its length. Note
that the quantiles are computed for each motif separately, and therefore this might be slow for intervals with un-normalized lengths."><meta property="og:description" content="Extract for each interval its quantile in the genome for each motif given its length. Note
that the quantiles are computed for each motif separately, and therefore this might be slow for intervals with un-normalized lengths."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">prego</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.3</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Extract quantiles of pwm of intervals from a motif database</h1>

      <div class="d-none name"><code>gextract_pwm.quantile.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Extract for each interval its quantile in the genome for each motif given its length. Note
that the quantiles are computed for each motif separately, and therefore this might be slow for intervals with un-normalized lengths.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">gextract_pwm.quantile</span><span class="op">(</span></span>
<span>  <span class="va">intervals</span>,</span>
<span>  motifs <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  dataset <span class="op">=</span> <span class="va">MOTIF_DB</span>,</span>
<span>  percision <span class="op">=</span> <span class="fl">0.01</span>,</span>
<span>  spat <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  spat_min <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  spat_max <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  bidirect <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  prior <span class="op">=</span> <span class="fl">0.01</span>,</span>
<span>  func <span class="op">=</span> <span class="st">"logSumExp"</span>,</span>
<span>  n_sequences <span class="op">=</span> <span class="fl">10000</span>,</span>
<span>  dist_from_edge <span class="op">=</span> <span class="fl">3000000</span>,</span>
<span>  chromosomes <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  parallel <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/options.html" class="external-link">getOption</a></span><span class="op">(</span><span class="st">"prego.parallel"</span>, <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-intervals">intervals<a class="anchor" aria-label="anchor" href="#arg-intervals"></a></dt>
<dd><p>misha intervals set</p></dd>


<dt id="arg-motifs">motifs<a class="anchor" aria-label="anchor" href="#arg-motifs"></a></dt>
<dd><p>names of specific motifs to extract from the dataset</p></dd>


<dt id="arg-dataset">dataset<a class="anchor" aria-label="anchor" href="#arg-dataset"></a></dt>
<dd><p>a data frame with PSSMs ('A', 'C', 'G' and 'T' columns), with an additional column 'motif' containing the motif name, for example <code>HOMER_motifs</code> or <code>JASPAR_motifs</code>, or <code><a href="all_motif_datasets.html">all_motif_datasets()</a></code>, or a MotifDB object.</p></dd>


<dt id="arg-percision">percision<a class="anchor" aria-label="anchor" href="#arg-percision"></a></dt>
<dd><p>the percision of the quantiles. Default is 0.01, which means that the quantiles will be computed for every 1% of the pwm.</p></dd>


<dt id="arg-spat">spat<a class="anchor" aria-label="anchor" href="#arg-spat"></a></dt>
<dd><p>a data frame with the spatial model (as returned from the <code>$spat</code> slot from the regression). Should contain a column called 'bin' and a column called 'spat_factor'.</p></dd>


<dt id="arg-spat-min">spat_min<a class="anchor" aria-label="anchor" href="#arg-spat-min"></a></dt>
<dd><p>the minimum position to use from the sequences. The default is 1.</p></dd>


<dt id="arg-spat-max">spat_max<a class="anchor" aria-label="anchor" href="#arg-spat-max"></a></dt>
<dd><p>the maximum position to use from the sequences. The default is the length of the sequences.</p></dd>


<dt id="arg-bidirect">bidirect<a class="anchor" aria-label="anchor" href="#arg-bidirect"></a></dt>
<dd><p>is the motif bi-directional. If TRUE, the reverse-complement of the motif will be used as well.</p></dd>


<dt id="arg-prior">prior<a class="anchor" aria-label="anchor" href="#arg-prior"></a></dt>
<dd><p>a prior probability for each nucleotide.</p></dd>


<dt id="arg-func">func<a class="anchor" aria-label="anchor" href="#arg-func"></a></dt>
<dd><p>the function to use to combine the PWMs for each sequence. Either 'logSumExp' or 'max'. The default is 'logSumExp'.</p></dd>


<dt id="arg-n-sequences">n_sequences<a class="anchor" aria-label="anchor" href="#arg-n-sequences"></a></dt>
<dd><p>number of sequences to sample in order to compute the quantiles. The default is 1e4.</p></dd>


<dt id="arg-dist-from-edge">dist_from_edge<a class="anchor" aria-label="anchor" href="#arg-dist-from-edge"></a></dt>
<dd><p>The minimum distance from the edge of the chromosome for a region to start or end(default: 3e6)</p></dd>


<dt id="arg-chromosomes">chromosomes<a class="anchor" aria-label="anchor" href="#arg-chromosomes"></a></dt>
<dd><p>The chromosomes to sample from (default: all chromosomes)</p></dd>


<dt id="arg-parallel">parallel<a class="anchor" aria-label="anchor" href="#arg-parallel"></a></dt>
<dd><p>logical, whether to use parallel processing</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>a data frame with the quantiles of the pwm for each interval and motif. The quantiles columns would be of the form {motif}.q</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span> <span class="co"># \dontrun{</span></span></span>
<span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tanaylab.github.io/misha/" class="external-link">misha</a></span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://tanaylab.github.io/misha/reference/gdb.init.html" class="external-link">gdb.init_examples</a></span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">gextract_pwm.quantile</span><span class="op">(</span><span class="st">"annotations"</span>, motifs <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"JASPAR.CDX1"</span>, <span class="st">"JASPAR.CDX2"</span><span class="op">)</span>, dist_from_edge <span class="op">=</span> <span class="fl">100</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span> <span class="co"># }</span></span></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Aviezer Lifshitz, Amos Tanay.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer></div>





  </body></html>

